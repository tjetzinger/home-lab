# Prometheus Blackbox Exporter Helm values for home-lab
# Story: 24.2 - Configure Blackbox Exporter & Alertmanager Rules
# FR184: HTTP probe monitoring for OpenClaw gateway
# NFR104: Blackbox probe runs every 30 seconds
#
# Chart: prometheus-community/prometheus-blackbox-exporter

# Resource limits (conservative for home lab)
resources:
  requests:
    cpu: 50m
    memory: 64Mi
  limits:
    cpu: 100m
    memory: 128Mi

# Labels for home-lab consistency
podLabels:
  app.kubernetes.io/name: prometheus-blackbox-exporter
  app.kubernetes.io/part-of: home-lab
  app.kubernetes.io/managed-by: helm

# HTTP probe module configuration
config:
  modules:
    http_2xx:
      prober: http
      timeout: 10s
      http:
        valid_http_versions: ["HTTP/1.1", "HTTP/2.0"]
        valid_status_codes: [200, 301, 302]
        method: GET
        follow_redirects: true
        fail_if_ssl: false
        fail_if_not_ssl: true  # Require HTTPS
        tls_config:
          insecure_skip_verify: false  # Verify TLS certificates
    http_2xx_no_tls:
      prober: http
      timeout: 10s
      http:
        valid_http_versions: ["HTTP/1.1", "HTTP/2.0"]
        valid_status_codes: [200, 301, 302]
        method: GET
        follow_redirects: true

# ServiceMonitor for Blackbox Exporter itself
serviceMonitor:
  enabled: true
  labels:
    release: kube-prometheus-stack
